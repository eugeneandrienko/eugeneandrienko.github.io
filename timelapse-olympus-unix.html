<!doctype html>
<html lang="ru">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>  Как сделать timelapse видео на Olympus E-M10 II в Linux/FreeBSD | Dragon's notes
</title>
  <link rel="canonical" href="https://eugene-andrienko.com/timelapse-olympus-unix.html">

<link rel="apple-touch-icon" sizes="180x180" href="/theme/icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/theme/icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/theme/icons/favicon-16x16.png">
<link rel="manifest" href="/theme/icons/site.webmanifest">
<link rel="mask-icon" href="/theme/icons/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="/theme/icons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Драконовы заметки">
<meta name="application-name" content="Драконовы заметки">
<meta name="msapplication-TileColor" content="#00aba9">
<meta name="msapplication-config" content="/theme/icons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">    <link rel="manifest" href="https://eugene-andrienko.com/manifest.json">

  <link rel="stylesheet" href="https://eugene-andrienko.com/theme/css/lumen.min.css">

  <link rel="alternate" type="application/atom+xml" title="Full Atom Feed"
        href="https://eugene-andrienko.com/feeds/all.atom.xml">
  <link rel="alternate" type="application/atom+xml" title="Categories Atom Feed"
        href="https://eugene-andrienko.com/feeds/photo.atom.xml">  
  <meta name="description" content="Небольшая заметка о том, как взять Olympus, включить цейтраферную съёмку и собрать таймлапс-видео северного сияния с помощью пары Unix-утилит.">


</head>

<body>
  <header class="header">
    <div class="container">
<div class="row">
    <div class="col-sm-4">
      <a href="https://eugene-andrienko.com/">
        <img class="img-fluid rounded" src=https://eugene-andrienko.com/theme/images/siteimage.png alt="Dragon's notes">
      </a>
    </div>
  <div class="col-sm-8">
    <h1 class="title"><a href="https://eugene-andrienko.com/" style="color: black">Dragon's notes</a></h1>
      <ul class="list-inline">
          <li class="list-inline-item"><a class="fab fa-github" href="https://github.com/eugeneandrienko" target="_blank" style="color: black"></a></li>
          <li class="list-inline-item"><a class="fab fa-linkedin" href="https://www.linkedin.com/in/eugeneandrienko" target="_blank" style="color: black"></a></li>
          <li class="list-inline-item"><a class="fab fa-strava" href="https://www.strava.com/athletes/8248131" target="_blank" style="color: black"></a></li>
      </ul>
  </div>
</div>    </div>
  </header>

  <div class="main">
    <div class="container">
      <h1>  Как сделать timelapse видео на Olympus E-M10 <span class="caps">II</span> в&nbsp;Linux/FreeBSD
</h1>
  <article class="article">
    <div class="content">
      <div class="contents topic" id="topic-1">
<p class="topic-title">Содержание поста:</p>
<ul class="simple">
<li><a class="reference internal" href="#olympus-e-m10-ii" id="toc-entry-1">Настройка фотоаппарата (Olympus E-M10 <span class="caps">II</span>)</a></li>
<li><a class="reference internal" href="#raw" id="toc-entry-2">Обработка <span class="caps">RAW</span>-файлов</a></li>
<li><a class="reference internal" href="#timelapse" id="toc-entry-3">Сборка timelapse-видео</a></li>
<li><a class="reference internal" href="#instagram" id="toc-entry-4">Подготовка видео для Instagram</a></li>
</ul>
</div>
<p>Если хоть немного увлекаться съёмками северных сияний или астрофотографией, то
рано или поздно возникает желание записать видео со звёздным небом, где видно
либо вращение Земли, либо сполохи северного сияния. Понятное дело, что сколь бы
большой ни была <span class="caps">SD</span>-карта внутри фотоаппарата — места на ней всё равно не хватит,
если просто включить запись видео и не трогать штатив всю ночь.</p>
<p>Но выход есть! Вместо записи очередного 4K 60fps ролика можно снимать один кадр
с таким же разрешением, но, допустим, раз в 15 секунд. А потом склеить все
получившиеся фото в одно видео, которое ожидаемо будет меньше по размеру, и при
этом, даже с частотой съёмки в 0.0666(6) кадра в секунду — вращение Земли по
прежнему будет видно.</p>
<div class="section" id="olympus-e-m10-ii">
<h2>Настройка фотоаппарата (Olympus E-M10 <span class="caps">II</span>)</h2>
<p>Интервальная съёмка в Olympus E-M10 <span class="caps">II</span> включается через «Меню съёмки 1»:</p>
<div class="figure align-center" style="width: 50%">
<img alt="Настройка цейтраферной съёмки" class="img-fluid" src="https://eugene-andrienko.com/Photo/images/2022/IMG_20220116_185436.jpg"/>
</div>
<dl class="docutils">
<dt>Количество кадров</dt>
<dd>Выставлять по вкусу, ориентируясь на расчётную длительность работы
камеры. Меньше 30 кадров лучше не выставлять, иначе итоговое видео будет
слишком коротким и малосодержательным.</dd>
<dt>Ожидание</dt>
<dd>2 секунды, чтобы успели затухнуть колебания штатива от нажатия на кнопку спуска.</dd>
<dt>Интервал</dt>
<dd>Выставлять в зависимости от динамичности снимаемой сцены. Например, для
съёмки северного сияния стоит выставлять его в 1-2 секунды. Чем больше
интервал, тем сильнее будет остывать фотоаппарат между спусками затвора и
тем меньше будет шумов на итоговом снимке.</dd>
</dl>
<p>Сборку видео из снимков на фотоаппарате стоит отключить — всё равно ничего
хорошего из этого не получится. Снимки надо обрабатывать, возможно захочется
использовать для видео <span class="caps">FPS</span>, отличный от предлагаемых инженерами Олимпуса.</p>
</div>
<div class="section" id="raw">
<h2>Обработка <span class="caps">RAW</span>-файлов</h2>
<p>Полученные гигабайты фотографий надо будет обработать: обрезать их под
соотношение сторон 16:9, подкрутить экспокоррекцию, <span class="caps">HSV</span>, настройки шумодава,
угол поворота изображения и т.п.</p>
<p>В RawTherapee это делается следующим образом. Сначала производятся нужные
изменения для одного файла, которые сохраняются в отдельный профиль обработки изображения:</p>
<div class="figure align-center" style="width: 50%">
<img alt="Сохранение профиля" class="img-fluid" src="https://eugene-andrienko.com/Photo/images/2022/2022-01-16-193346_378x226_scrot.png"/>
</div>
<p>Потом выбираются все файлы и к ним применяется сохранённый профиль: ПКМ —
«Обработка операций профиля» — «Применить» — «Мои профили» — <em>имя сохранённого
профиля</em>. Обработанные файлы надо поместить в очередь на обработку и запустить
их в работу.</p>
</div>
<div class="section" id="timelapse">
<h2>Сборка timelapse-видео</h2>
<p>В силу исторических причин, для работы с видео я использовал mencoder —
перекодировщик от команды MPlayer’а. И лишь для одного узкого случая — для
Инстаграма — пришлось использовать ffmpeg.</p>
<p>Для склейки видео из обработанных jpg-файлов, в каталоге с этими файлами надо
запустить следующую команду:</p>
<pre class="literal-block">
mencoder mf://*.jpg -mf w=4616:h=3464:fps=10:type=jpg -ovc lavc -lavcopts
vcodec=msmpeg4v2:vbitrate=16000:keyint=15:mbd=2:trell -oac copy -o lapse.avi
</pre>
<p>В опции <tt class="docutils literal"><span class="pre">-mf</span> w=4616:h=3464:fps=10:type=jpg</tt> нужно указать ширину и высоту
используемых jpg-файлов. Там же можно настроить частоту кадров в итоговом видео
и тип используемых изображений, если он отличен от <span class="caps">JPEG</span>.</p>
</div>
<div class="section" id="instagram">
<h2>Подготовка видео для Instagram</h2>
<p>Для Instagram требуется видео в формате <span class="caps">MP4</span>, к тому же — не в огромном
разрешении 4616x3464.</p>
<p>Чтобы получить из jpg-файлов таймлапс в меньшем разрешении, можно использовать команду:</p>
<pre class="literal-block">
mencoder mf://*.jpg -mf w=4616:h=3464:fps=10:type=jpg -ovc lavc -lavcopts
vcodec=msmpeg4v2:vbitrate=16000:keyint=15:mbd=2:trell -oac copy -vf
scale=1154:-10 -o lapse_scaled.avi
</pre>
<p>которая отличается от предыдущей лишь опцией <tt class="docutils literal"><span class="pre">-vf</span> <span class="pre">scale=1154:-10</span></tt>, где
<tt class="docutils literal">1154</tt> — горизонтальное разрешение отмасштабированного видео. Вертикальное
разрешение будет вычислено автоматически, на основе разрешения исходных кадров.</p>
<p>А для перекодирования видео в <span class="caps">MP4</span> для Instagram, используется следующая команда:</p>
<pre class="literal-block">
ffmpeg -i lapse_scaled.avi lapse_scaled.mp4
</pre>
</div>

    </div>
    <br/>
    <header class="text-right">
      <small>
        <ul class="list-inline">
          <li class="list-inline-item">
            <i class="fas fa-folder-open"></i>
            <a href="https://eugene-andrienko.com/category/photo.html">Photo</a>
          </li>
          <li class="list-inline-item text-muted" title="2022-01-16T18:30:00+03:00">
            16 January 2022 (Sun)
          </li>
        </ul>
      </small>
    </header>
  </article>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
<div class="row">
  <ul class="col-sm-4 list-inline">
    <li class="list-inline-item"><a href="https://eugene-andrienko.com/archives.html">Archive</a></li>
    <li class="list-inline-item"><a href="https://eugene-andrienko.com/categories.html">Categories</a></li>
      <li class="list-inline-item"><a href="https://eugene-andrienko.com/tags.html">Tags</a></li>
  </ul>
  <p class="col-sm-8 text-sm-right text-muted">
      <small>
        Built by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a>
        / <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">&#x2728;</a>.

        Fonts: <a href="https://github.com/typiconman/fonts-cu" target="_blank">Monomakh Unicode</a>,
        <a href="https://github.com/akryukov/oldstand" target="_blank">Old Standard</a>,
        <a href="https://github.com/slavonic/FiraSlav" target="_blank">Fira Slav</a>
      </small>
  </p>
</div>    </div>
  </footer>

  <link rel="stylesheet" href="https://eugene-andrienko.com/theme/css/fontawesome.min.css">
  <link rel="stylesheet" href="https://eugene-andrienko.com/theme/css/pygments/emacs.min.css">
  <link rel="stylesheet" href="https://eugene-andrienko.com/theme/css/theme.css">
</body>

</html>